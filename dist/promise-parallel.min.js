var promiseParallelSerial=function(t){"use strict";var n=new(function(){function t(){this.list=[],this.waitList=[],this.parallelNum=2}return Object.defineProperty(t.prototype,"parallel",{get:function(){return this.parallelNum},set:function(t){this.parallelNum=t},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var n=this;if("function"!=typeof t)throw new Error("fn must be a function");if(this.list.length<this.parallelNum){this.list.push(t);var e=t();if("function"!=typeof e.then)throw new Error("fn function must return a <Promise>");return this.changeList(e),e}return new Promise((function(e,r){try{n.waitList.push({promise:t,cb:e})}catch(t){r(t)}}))},t.prototype.changeList=function(t){var n=this;null==t||t.then((function(){if(n.waitList.length>0){var t=n.waitList.shift(),e=null==t?void 0:t.promise();null==e||e.then((function(){null==t||t.cb()})),e&&n.changeList(e)}else n.list.length=0})).catch((function(t){console.log(t)}))},t}());return t.changeParallel=function(t){if(null!=t){if("number"!=typeof t)throw new TypeError("function changeParallel params must be number");return t=t<0?0:t,n.parallel=t,t}return n.parallel},t.default=function(t,e){for(var r,i=[],l=2;l<arguments.length;l++)i[l-2]=arguments[l];return null===(r=n.add((function(){return t.apply(e,i)})))||void 0===r?void 0:r.then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))},t}({});
