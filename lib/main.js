"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=new(function(){function t(){this.list=[],this.waitList=[],this.parallelNum=2}return Object.defineProperty(t.prototype,"parallel",{get:function(){return this.parallelNum},set:function(t){this.parallelNum=t},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var e=this;if(this.list.length<this.parallelNum){this.list.push(t);var n=t();return this.changeList(n),n}return new Promise((function(n,i){try{e.waitList.push({promise:t,cb:n})}catch(t){i(t)}}))},t.prototype.changeList=function(t){var e=this;null==t||t.then((function(){if(e.waitList.length>0){var t=e.waitList.shift(),n=null==t?void 0:t.promise();null==n||n.then((function(){null==t||t.cb()})),n&&e.changeList(n)}else e.list.length=0}))},t}());exports.changeParallel=function(e){return e?(e=e<0?0:e,t.parallel=e,e):t.parallel},exports.default=function(e,n){for(var i,l=[],r=2;r<arguments.length;r++)l[r-2]=arguments[r];return null===(i=t.add((function(){return e.apply(n,l)})))||void 0===i?void 0:i.then((function(t){return Promise.resolve(t)}))};
