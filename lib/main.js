"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(){this.list=[],this.waitList=[],this.parallelNum=2}return Object.defineProperty(t.prototype,"parallel",{get:function(){return this.parallelNum},set:function(t){this.parallelNum=t},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var e=this;if(this.list.length<this.parallelNum){this.list.push(t);var n=t();return this.changeList(n),n}return new Promise((function(n,r){try{e.waitList.push({promise:t,cb:n})}catch(t){r(t)}}))},t.prototype.changeList=function(t){var e=this;t.then((function(){if(e.waitList.length>0){var t=e.waitList.shift(),n=null==t?void 0:t.promise();null==n||n.then((function(){null==t||t.cb()})),n&&e.changeList(n)}}))},t}(),e=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return new Promise((function(r){t.apply(e,n).then((function(t){return r(t)}))}))},n=new t;exports.changeParallel=function(t){if(!t)return n.parallel;t=t<0?0:t,n.parallel=t},exports.default=function(t,r){for(var i=[],l=2;l<arguments.length;l++)i[l-2]=arguments[l];return n.add((function(){return e(t,r,i)})).then((function(t){return Promise.resolve(t)}))};
